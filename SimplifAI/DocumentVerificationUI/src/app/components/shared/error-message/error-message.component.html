<!-- Modal Overlay for Modal Variant -->
<div class="error-overlay" *ngIf="variant === 'modal' && visible" (click)="onDismiss()">
  <div class="error-modal" (click)="$event.stopPropagation()">
    <div class="error-modal-content">
      <!-- Modal Header -->
      <div class="error-header">
        <div class="error-icon" *ngIf="showIcon">
          <svg *ngIf="iconName === 'error'" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
            <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
          </svg>
          <svg *ngIf="iconName === 'warning'" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" stroke="currentColor" stroke-width="2"/>
            <line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" stroke-width="2"/>
            <circle cx="12" cy="17" r="1" fill="currentColor"/>
          </svg>
          <svg *ngIf="iconName === 'info'" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <line x1="12" y1="16" x2="12" y2="12" stroke="currentColor" stroke-width="2"/>
            <circle cx="12" cy="8" r="1" fill="currentColor"/>
          </svg>
        </div>
        <h3 class="error-title">{{ title }}</h3>
        <button class="error-close" *ngIf="dismissible" (click)="onDismiss()" aria-label="Close error message">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
            <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>
      
      <!-- Modal Body -->
      <div class="error-body">
        <p class="error-message">{{ message }}</p>
        
        <!-- Error Code -->
        <div class="error-code" *ngIf="errorCode">
          <span class="error-code-label">Error Code:</span>
          <code class="error-code-value">{{ errorCode }}</code>
        </div>
        
        <!-- Error Details -->
        <div class="error-details" *ngIf="errorDetails && (showDetails || detailsExpanded)">
          <button 
            class="error-details-toggle" 
            *ngIf="collapsible && errorDetails"
            (click)="toggleDetails()"
            [attr.aria-expanded]="detailsExpanded"
          >
            <span>{{ detailsExpanded ? 'Hide' : 'Show' }} Details</span>
            <svg 
              width="16" 
              height="16" 
              viewBox="0 0 24 24" 
              fill="none" 
              xmlns="http://www.w3.org/2000/svg"
              [class.rotated]="detailsExpanded"
            >
              <polyline points="6,9 12,15 18,9" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
          <div class="error-details-content" *ngIf="detailsExpanded || showDetails">
            <pre class="error-details-text">{{ errorDetails }}</pre>
          </div>
        </div>
      </div>
      
      <!-- Modal Actions -->
      <div class="error-actions" *ngIf="getAllActions().length > 0">
        <button
          *ngFor="let action of getAllActions()"
          class="error-action-btn"
          [class]="'btn-' + (action.style || 'secondary')"
          [disabled]="action.loading"
          (click)="onActionClick(action)"
        >
          <span class="action-spinner" *ngIf="action.loading">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-dasharray="31.416" stroke-dashoffset="31.416">
                <animate attributeName="stroke-dasharray" dur="2s" values="0 31.416;15.708 15.708;0 31.416" repeatCount="indefinite"/>
                <animate attributeName="stroke-dashoffset" dur="2s" values="0;-15.708;-31.416" repeatCount="indefinite"/>
              </circle>
            </svg>
          </span>
          <span class="action-label">{{ action.label }}</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Inline/Banner Error -->
<div [class]="containerClass" *ngIf="variant !== 'modal' && visible">
  <div class="error-content">
    <!-- Icon -->
    <div class="error-icon" *ngIf="showIcon">
      <svg *ngIf="iconName === 'error'" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
        <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
      </svg>
      <svg *ngIf="iconName === 'warning'" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z" stroke="currentColor" stroke-width="2"/>
        <line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" stroke-width="2"/>
        <circle cx="12" cy="17" r="1" fill="currentColor"/>
      </svg>
      <svg *ngIf="iconName === 'info'" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
        <line x1="12" y1="16" x2="12" y2="12" stroke="currentColor" stroke-width="2"/>
        <circle cx="12" cy="8" r="1" fill="currentColor"/>
      </svg>
    </div>
    
    <!-- Content -->
    <div class="error-main">
      <div class="error-header-inline">
        <h4 class="error-title">{{ title }}</h4>
        <button class="error-close" *ngIf="dismissible" (click)="onDismiss()" aria-label="Close error message">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2"/>
            <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>
      
      <p class="error-message">{{ message }}</p>
      
      <!-- Error Code -->
      <div class="error-code" *ngIf="errorCode">
        <span class="error-code-label">Error Code:</span>
        <code class="error-code-value">{{ errorCode }}</code>
      </div>
      
      <!-- Error Details -->
      <div class="error-details" *ngIf="errorDetails && (showDetails || detailsExpanded)">
        <button 
          class="error-details-toggle" 
          *ngIf="collapsible && errorDetails"
          (click)="toggleDetails()"
          [attr.aria-expanded]="detailsExpanded"
        >
          <span>{{ detailsExpanded ? 'Hide' : 'Show' }} Details</span>
          <svg 
            width="14" 
            height="14" 
            viewBox="0 0 24 24" 
            fill="none" 
            xmlns="http://www.w3.org/2000/svg"
            [class.rotated]="detailsExpanded"
          >
            <polyline points="6,9 12,15 18,9" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
        <div class="error-details-content" *ngIf="detailsExpanded || showDetails">
          <pre class="error-details-text">{{ errorDetails }}</pre>
        </div>
      </div>
      
      <!-- Actions -->
      <div class="error-actions" *ngIf="getAllActions().length > 0">
        <button
          *ngFor="let action of getAllActions()"
          class="error-action-btn"
          [class]="'btn-' + (action.style || 'secondary')"
          [disabled]="action.loading"
          (click)="onActionClick(action)"
        >
          <span class="action-spinner" *ngIf="action.loading">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" stroke-dasharray="31.416" stroke-dashoffset="31.416">
                <animate attributeName="stroke-dasharray" dur="2s" values="0 31.416;15.708 15.708;0 31.416" repeatCount="indefinite"/>
                <animate attributeName="stroke-dashoffset" dur="2s" values="0;-15.708;-31.416" repeatCount="indefinite"/>
              </circle>
            </svg>
          </span>
          <span class="action-label">{{ action.label }}</span>
        </button>
      </div>
    </div>
  </div>
</div>